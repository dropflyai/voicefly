-- Fix audit logs RLS to allow inserts from authenticated users
-- Drop and recreate the insert policy

DROP POLICY IF EXISTS "service_role_can_insert" ON audit_logs;

-- Allow ALL authenticated users to insert audit logs
CREATE POLICY "authenticated_can_insert_audit_logs"
ON audit_logs
FOR INSERT
TO authenticated
WITH CHECK (true);

-- Verify policies
SELECT policyname, roles, cmd
FROM pg_policies
WHERE tablename = 'audit_logs';
